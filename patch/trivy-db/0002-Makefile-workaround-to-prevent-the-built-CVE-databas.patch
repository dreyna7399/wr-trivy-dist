From 9a1d4e816bb24ddc20aef38d1997c423ada13761 Mon Sep 17 00:00:00 2001
From: William Lyu <William.Lyu@windriver.com>
Date: Mon, 4 Dec 2023 10:00:47 -0500
Subject: [PATCH 2/3] Makefile: workaround to prevent the built CVE database
 file from expiring too quickly

The CVE database file generated expires after 6h by default. Currently,
if trivy attempts to update the CVE database file, the wrlinux part of
the database will be wiped. So, we set an absurdly large expiry time for
the CVE database file to prevent trivy from updating it.

After trivy code is modified to handle wrlinux CVE database update
properly, this patch should be dropped.

Signed-off-by: William Lyu <William.Lyu@windriver.com>
---
 Makefile | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/Makefile b/Makefile
index 0582d63..e1d9aec 100644
--- a/Makefile
+++ b/Makefile
@@ -77,7 +77,7 @@ db-fetch-langs:
 
 .PHONY: db-build
 db-build: trivy-db
-	./trivy-db build --cache-dir ./$(CACHE_DIR) --output-dir ./$(OUT_DIR) --update-interval 6h
+	./trivy-db build --cache-dir ./$(CACHE_DIR) --output-dir ./$(OUT_DIR) --update-interval 1752000h
 
 .PHONY: db-compact
 db-compact: $(GOBIN)/bbolt out/trivy.db
-- 
2.25.1

